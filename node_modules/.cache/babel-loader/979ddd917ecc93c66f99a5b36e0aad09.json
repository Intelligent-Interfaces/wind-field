{"ast":null,"code":"import * as tslib_1 from \"tslib\";\nimport { Monophonic } from \"./Monophonic\";\nimport { MonoSynth } from \"./MonoSynth\";\nimport { Signal } from \"../signal/Signal\";\nimport { readOnly } from \"../core/util/Interface\";\nimport { LFO } from \"../source/oscillator/LFO\";\nimport { Gain } from \"../core/context/Gain\";\nimport { Multiply } from \"../signal/Multiply\";\nimport { deepMerge, omitFromObject, optionsFromArguments } from \"../core/util/Defaults\";\n/**\n * DuoSynth is a monophonic synth composed of two [[MonoSynths]] run in parallel with control over the\n * frequency ratio between the two voices and vibrato effect.\n * @example\n * import { DuoSynth } from \"tone\";\n * const duoSynth = new DuoSynth().toDestination();\n * duoSynth.triggerAttackRelease(\"C4\", \"2n\");\n * @category Instrument\n */\n\nvar DuoSynth =\n/** @class */\nfunction (_super) {\n  tslib_1.__extends(DuoSynth, _super);\n\n  function DuoSynth() {\n    var _this = _super.call(this, optionsFromArguments(DuoSynth.getDefaults(), arguments)) || this;\n\n    _this.name = \"DuoSynth\";\n    var options = optionsFromArguments(DuoSynth.getDefaults(), arguments);\n    _this.voice0 = new MonoSynth(Object.assign(options.voice0, {\n      context: _this.context,\n      onsilence: function () {\n        return _this.onsilence(_this);\n      }\n    }));\n    _this.voice1 = new MonoSynth(Object.assign(options.voice1, {\n      context: _this.context\n    }));\n    _this.harmonicity = new Multiply({\n      context: _this.context,\n      units: \"positive\",\n      value: options.harmonicity\n    });\n    _this._vibrato = new LFO({\n      frequency: options.vibratoRate,\n      context: _this.context,\n      min: -50,\n      max: 50\n    }); // start the vibrato immediately\n\n    _this._vibrato.start();\n\n    _this.vibratoRate = _this._vibrato.frequency;\n    _this._vibratoGain = new Gain({\n      context: _this.context,\n      units: \"normalRange\",\n      gain: options.vibratoAmount\n    });\n    _this.vibratoAmount = _this._vibratoGain.gain;\n    _this.frequency = new Signal({\n      context: _this.context,\n      units: \"frequency\",\n      value: 440\n    });\n    _this.detune = new Signal({\n      context: _this.context,\n      units: \"cents\",\n      value: options.detune\n    }); // control the two voices frequency\n\n    _this.frequency.connect(_this.voice0.frequency);\n\n    _this.frequency.chain(_this.harmonicity, _this.voice1.frequency);\n\n    _this._vibrato.connect(_this._vibratoGain);\n\n    _this._vibratoGain.fan(_this.voice0.detune, _this.voice1.detune);\n\n    _this.detune.fan(_this.voice0.detune, _this.voice1.detune);\n\n    _this.voice0.connect(_this.output);\n\n    _this.voice1.connect(_this.output);\n\n    readOnly(_this, [\"voice0\", \"voice1\", \"frequency\", \"vibratoAmount\", \"vibratoRate\"]);\n    return _this;\n  }\n\n  DuoSynth.prototype.getLevelAtTime = function (time) {\n    time = this.toSeconds(time);\n    return this.voice0.envelope.getValueAtTime(time) + this.voice1.envelope.getValueAtTime(time);\n  };\n\n  DuoSynth.getDefaults = function () {\n    return deepMerge(Monophonic.getDefaults(), {\n      vibratoAmount: 0.5,\n      vibratoRate: 5,\n      harmonicity: 1.5,\n      voice0: deepMerge(omitFromObject(MonoSynth.getDefaults(), Object.keys(Monophonic.getDefaults())), {\n        filterEnvelope: {\n          attack: 0.01,\n          decay: 0.0,\n          sustain: 1,\n          release: 0.5\n        },\n        envelope: {\n          attack: 0.01,\n          decay: 0.0,\n          sustain: 1,\n          release: 0.5\n        }\n      }),\n      voice1: deepMerge(omitFromObject(MonoSynth.getDefaults(), Object.keys(Monophonic.getDefaults())), {\n        filterEnvelope: {\n          attack: 0.01,\n          decay: 0.0,\n          sustain: 1,\n          release: 0.5\n        },\n        envelope: {\n          attack: 0.01,\n          decay: 0.0,\n          sustain: 1,\n          release: 0.5\n        }\n      })\n    });\n  };\n  /**\n   * Trigger the attack portion of the note\n   */\n\n\n  DuoSynth.prototype._triggerEnvelopeAttack = function (time, velocity) {\n    // @ts-ignore\n    this.voice0._triggerEnvelopeAttack(time, velocity); // @ts-ignore\n\n\n    this.voice1._triggerEnvelopeAttack(time, velocity);\n  };\n  /**\n   * Trigger the release portion of the note\n   */\n\n\n  DuoSynth.prototype._triggerEnvelopeRelease = function (time) {\n    // @ts-ignore\n    this.voice0._triggerEnvelopeRelease(time); // @ts-ignore\n\n\n    this.voice1._triggerEnvelopeRelease(time);\n\n    return this;\n  };\n\n  DuoSynth.prototype.dispose = function () {\n    _super.prototype.dispose.call(this);\n\n    this.voice0.dispose();\n    this.voice1.dispose();\n    this.frequency.dispose();\n    this.detune.dispose();\n\n    this._vibrato.dispose();\n\n    this.vibratoRate.dispose();\n\n    this._vibratoGain.dispose();\n\n    this.harmonicity.dispose();\n    return this;\n  };\n\n  return DuoSynth;\n}(Monophonic);\n\nexport { DuoSynth };","map":{"version":3,"sources":["../../../Tone/instrument/DuoSynth.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["import * as tslib_1 from \"tslib\";\nimport { Monophonic } from \"./Monophonic\";\nimport { MonoSynth } from \"./MonoSynth\";\nimport { Signal } from \"../signal/Signal\";\nimport { readOnly } from \"../core/util/Interface\";\nimport { LFO } from \"../source/oscillator/LFO\";\nimport { Gain, } from \"../core/context/Gain\";\nimport { Multiply } from \"../signal/Multiply\";\nimport { deepMerge, omitFromObject, optionsFromArguments } from \"../core/util/Defaults\";\n/**\n * DuoSynth is a monophonic synth composed of two [[MonoSynths]] run in parallel with control over the\n * frequency ratio between the two voices and vibrato effect.\n * @example\n * import { DuoSynth } from \"tone\";\n * const duoSynth = new DuoSynth().toDestination();\n * duoSynth.triggerAttackRelease(\"C4\", \"2n\");\n * @category Instrument\n */\nvar DuoSynth = /** @class */ (function (_super) {\n    tslib_1.__extends(DuoSynth, _super);\n    function DuoSynth() {\n        var _this = _super.call(this, optionsFromArguments(DuoSynth.getDefaults(), arguments)) || this;\n        _this.name = \"DuoSynth\";\n        var options = optionsFromArguments(DuoSynth.getDefaults(), arguments);\n        _this.voice0 = new MonoSynth(Object.assign(options.voice0, {\n            context: _this.context,\n            onsilence: function () { return _this.onsilence(_this); }\n        }));\n        _this.voice1 = new MonoSynth(Object.assign(options.voice1, {\n            context: _this.context,\n        }));\n        _this.harmonicity = new Multiply({\n            context: _this.context,\n            units: \"positive\",\n            value: options.harmonicity,\n        });\n        _this._vibrato = new LFO({\n            frequency: options.vibratoRate,\n            context: _this.context,\n            min: -50,\n            max: 50\n        });\n        // start the vibrato immediately\n        _this._vibrato.start();\n        _this.vibratoRate = _this._vibrato.frequency;\n        _this._vibratoGain = new Gain({\n            context: _this.context,\n            units: \"normalRange\",\n            gain: options.vibratoAmount\n        });\n        _this.vibratoAmount = _this._vibratoGain.gain;\n        _this.frequency = new Signal({\n            context: _this.context,\n            units: \"frequency\",\n            value: 440\n        });\n        _this.detune = new Signal({\n            context: _this.context,\n            units: \"cents\",\n            value: options.detune\n        });\n        // control the two voices frequency\n        _this.frequency.connect(_this.voice0.frequency);\n        _this.frequency.chain(_this.harmonicity, _this.voice1.frequency);\n        _this._vibrato.connect(_this._vibratoGain);\n        _this._vibratoGain.fan(_this.voice0.detune, _this.voice1.detune);\n        _this.detune.fan(_this.voice0.detune, _this.voice1.detune);\n        _this.voice0.connect(_this.output);\n        _this.voice1.connect(_this.output);\n        readOnly(_this, [\"voice0\", \"voice1\", \"frequency\", \"vibratoAmount\", \"vibratoRate\"]);\n        return _this;\n    }\n    DuoSynth.prototype.getLevelAtTime = function (time) {\n        time = this.toSeconds(time);\n        return this.voice0.envelope.getValueAtTime(time) + this.voice1.envelope.getValueAtTime(time);\n    };\n    DuoSynth.getDefaults = function () {\n        return deepMerge(Monophonic.getDefaults(), {\n            vibratoAmount: 0.5,\n            vibratoRate: 5,\n            harmonicity: 1.5,\n            voice0: deepMerge(omitFromObject(MonoSynth.getDefaults(), Object.keys(Monophonic.getDefaults())), {\n                filterEnvelope: {\n                    attack: 0.01,\n                    decay: 0.0,\n                    sustain: 1,\n                    release: 0.5\n                },\n                envelope: {\n                    attack: 0.01,\n                    decay: 0.0,\n                    sustain: 1,\n                    release: 0.5\n                }\n            }),\n            voice1: deepMerge(omitFromObject(MonoSynth.getDefaults(), Object.keys(Monophonic.getDefaults())), {\n                filterEnvelope: {\n                    attack: 0.01,\n                    decay: 0.0,\n                    sustain: 1,\n                    release: 0.5\n                },\n                envelope: {\n                    attack: 0.01,\n                    decay: 0.0,\n                    sustain: 1,\n                    release: 0.5\n                }\n            }),\n        });\n    };\n    /**\n     * Trigger the attack portion of the note\n     */\n    DuoSynth.prototype._triggerEnvelopeAttack = function (time, velocity) {\n        // @ts-ignore\n        this.voice0._triggerEnvelopeAttack(time, velocity);\n        // @ts-ignore\n        this.voice1._triggerEnvelopeAttack(time, velocity);\n    };\n    /**\n     * Trigger the release portion of the note\n     */\n    DuoSynth.prototype._triggerEnvelopeRelease = function (time) {\n        // @ts-ignore\n        this.voice0._triggerEnvelopeRelease(time);\n        // @ts-ignore\n        this.voice1._triggerEnvelopeRelease(time);\n        return this;\n    };\n    DuoSynth.prototype.dispose = function () {\n        _super.prototype.dispose.call(this);\n        this.voice0.dispose();\n        this.voice1.dispose();\n        this.frequency.dispose();\n        this.detune.dispose();\n        this._vibrato.dispose();\n        this.vibratoRate.dispose();\n        this._vibratoGain.dispose();\n        this.harmonicity.dispose();\n        return this;\n    };\n    return DuoSynth;\n}(Monophonic));\nexport { DuoSynth };\n//# sourceMappingURL=DuoSynth.js.map"]},"metadata":{},"sourceType":"module"}